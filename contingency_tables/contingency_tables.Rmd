---
title: "Kontignenční tabulka"
author: "Filip Děchtěrenko"
date: '`r format(Sys.time(), "%d %B, %Y")`'
output: html_document
---

```{r setup, code = readLines("D:/Documents/git/exams_vspj/common_chunks.R")}

```

```{r data generation, echo = FALSE, results = "hide"}
df_assignmnent <- get_var_desc()
df_vardesc <- df_assignmnent$var_desc %>% unnest(cols = c(data))
text_question <- sample(df_assignmnent$question,1)

n <- sample(100:500,1)
r <- runif(1,-1,1)

df_currvars <- df_vardesc %>% 
  filter(type == "factor") %>% 
  sample_n(2) %>% 
  rowwise() %>% 
  mutate(n_levels = get_n_factor_levels(values))


df <- generate_contingency_table(n,r, x_lev = df_currvars$n_levels[1],y_lev = df_currvars$n_levels[2])

colnames(df) <- get_factor_levels(df_currvars$values[1])
rownames(df) <- get_factor_levels(df_currvars$values[2])



```

Question
========

```{r, results='asis'}
cat(eval(parse(text=text_question)))
```

Získali jsme data o proměnných `r df_currvars$name[1]` a `r df_currvars$name[2]` a zajímá nás, zda je mezi proměnnými vztah.

Data vypadají následovně:

```{r echo = FALSE}
pander::pander(df)
```

Určete koeficient asociace (s přesností na 2 desetinná místa)

Solution
========
Pro danou kontingenční tabulku spočítáme vztah pomocí vzorce XXX, výsledek je `r fmt(cor(x,y),2)`.  

Meta-information
================
extype: num
exsolution: `r fmt(cor(x,y),2)`
exname: cont_table
extol: 0.01