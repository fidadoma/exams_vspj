---
title: "Regrese"
author: "Filip Děchtěrenko"
date: '`r format(Sys.time(), "%d %B, %Y")`'
output: html_document
---

```{r setup, code = readLines("D:/Documents/git/exams_vspj/common_chunks.R")}

```


```{r data generation, echo = FALSE}

df_assignmnent <- get_var_desc()
df_vardesc <- df_assignmnent$var_desc %>% unnest(cols = c(data))
text_question <- sample(df_assignmnent$question,1)

n <- sample(5:10,1)
r <- runif(1,-1,1)

df_currvars <- sample_vars(df_vardesc, nvar = 2)

# generate X,Y data
df_data <- safe_generate_correlated_data(n,r,df_currvars)

lm1 <- lm(Y~X)

#cor(X, Y)  # yay!
#cor(X*0.01 + 42, Y*3 - 1) 
```



Question
========
```{r, results='asis'}
cat(eval(parse(text=text_question)))
```

Spočítejte koeficient determinace ($R^2$) předpovídající `r df_currvars$name[1]` v závislosti na `r df_currvars$name[2]`. Data vypadají následovně:

```{r graf,echo = FALSE, warning =F,message=F}
df_data %>% knitr::kable()
```

Solution
========
Když si vizualizujeme data, vypadají následovně:

```{r plot, fig.path = "", fig.cap = ""}
df_data %>% 
  ggplot(aes(x=!!sym(colnames(df_data)[1]), y=!!sym(colnames(df_data)[2]))) +
  geom_point() + 
  theme(aspect.ratio = 1)
```

Lineární závislost popisujeme rovnicí ve tvaru $y = b_1x+b_0$. Pro výpočet koeficientu determinace použijeme funkci CORREL()*CORREL()

V tomto případě je koeficient determinace roven `r exams::fmt(summary(lm1)$r.squared,2)`




Meta-information
================
extype: num
exsolution: `r exams::fmt(summary(lm1)$r.squared,2)`
exname: regression_R2
extol: 0.01