---
title: "Korelace 3"
author: "Filip Děchtěrenko"
date: '`r format(Sys.time(), "%d %B, %Y")`'
output: html_document
---

```{r}
library(tidyverse)
theme_set(theme_classic(12))

x_lab <- "výsledky matematického testu"
y_lab <- "výsledky verbálního testu"
```

```{r data generation, echo = FALSE, results = "hide"}
## DATA GENERATION
n <- sample(10:14, 1)
x <- sample(30:90,n)

reg_type <- ifelse(rnorm(1) < 0.2,"quadratic","linear")
if(reg_type == "quadratic") {
  b2 <- runif(1, min = -0.3, max = 0.3)
  b1 <- runif(1, min = -0.3, max = 0.3)
  b0 <- runif(1, min = 30, max = 90)
  y <- round(b2*x^2+b1*x +b0)
  y[y<0] <- 0
  
} else {
  b1 <- runif(1, min = -1, max = 1)
  b0 <- runif(1, min = 30, max = 90)
  y <- b1*x +b0
  y <- round(y + runif(n,-10,10))
  y[y<0] <- 0
}


```

Question
========
U `r n` náhodně vybraných studentů byly zjišťovány jejich matematické a verbální schopnosti. 
Výsledky matematického a verbálního testu jsou uvedeny v tabulce.


Data vypadají následovně:

```{r echo = FALSE}
knitr::kable(tibble(`výsledky matematického testu`=x,`výsledky verbálního testu`=y))
```

Určete Pearsonův korelační koeficient (s přesností na 2 desetinná místa)

Solution
========
Korelaci spočítáme pomocí funkce CORREL, výsledek je `r fmt(cor(x,y),2)`.  
Bodový graf vypadá následovně:

```{r echo = FALSE}
df <- tibble(x,y)
ggplot(df,aes(x,y)) + geom_point() + theme(aspect.ratio = 1) + 
  xlab(x_lab) + ylab(y_lab)
```

Meta-information
================
extype: num
exsolution: `r fmt(cor(x,y),2)`
exname: correlation
extol: 0.01